#include "credits.h"
#include "kickflipfont.h"
#include "graphics/spritefont.h"
#include "graphics/image.h"
#include "graphics/gfx.h"
#include "controls/controller.h"
#include "scene/scene_management.h"

#include "../data/fonts/fonts.h"

/* Width 32 */
/* Height 32 */

unsigned short __attribute__((aligned(8))) discordlogo_img[] = {
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfaa4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 
0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf284, 0xf2a4, 0xf2c5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a5, 0xf2a4, 0xf2c4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 
0x0, 0x0, 0xeaa4, 0xeaa4, 0xf284, 0xf285, 0xd244, 0x89a3, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x8162, 0x7963, 0x9182, 0xca64, 0xeaa5, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a5, 0xea65, 0x6122, 0x800, 0x3081, 0x3081, 0x2881, 0x2881, 0x2881, 0x2881, 0x2881, 0x2881, 0x3081, 0x38a1, 0x3081, 0x2881, 0x2881, 0x3081, 0x2881, 0x3081, 0x0, 0x58e2, 0xe264, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a5, 0xd244, 0x38a1, 0x48c1, 0xd264, 0xca45, 0xd224, 0xc244, 0xc224, 0xc224, 0xc244, 0xca24, 0xca24, 0xba04, 0xc224, 0xc224, 0xca24, 0xd244, 0xca44, 0xda84, 0x48c2, 0x2860, 0xda63, 0xf2a4, 0xea84, 0xea84, 0xf284, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a5, 0xd244, 0x40a1, 0x6921, 0xfae4, 0xfae5, 0xfac4, 0xfac4, 0xfac4, 0xfac4, 0xfaa4, 0xfae5, 0xca24, 0x6922, 0xca24, 0xfae5, 0xfaa4, 0xfac4, 0xfae4, 0xfb25, 0x6923, 0x3081, 0xda44, 0xf2a4, 0xea84, 0xea84, 0xf284, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a5, 0xd244, 0x40a1, 0x6101, 0xfae5, 0xc224, 0x7962, 0xca24, 0xf2a3, 0xe283, 0xf2a4, 0xf2a4, 0x5121, 0x1840, 0xba03, 0xf2c5, 0xd244, 0x7942, 0xb223, 0xfb05, 0x6123, 0x3081, 0xda44, 0xf2a4, 0xea84, 0xea84, 0xf284, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd244, 0x40a1, 0x6922, 0xd264, 0x48c2, 0x40a1, 0xba04, 0x89c2, 0x99c2, 0xfac5, 0xba03, 0x1080, 0x7962, 0xba04, 0xa1c2, 0xba23, 0x40c1, 0x38a1, 0xd264, 0x6102, 0x3081, 0xda64, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd244, 0x48c1, 0x5102, 0x5102, 0x1041, 0xba03, 0x99c3, 0x41, 0x30a2, 0xd205, 0x6122, 0x28a0, 0xa1c3, 0x8964, 0x6102, 0xa1e2, 0xc224, 0x1020, 0x5901, 0x50e2, 0x38a1, 0xda64, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd244, 0x40c1, 0x5922, 0x8983, 0x2040, 0x8163, 0xa1e3, 0x3081, 0x6902, 0x99c3, 0x1881, 0x7983, 0xda84, 0x8982, 0x7143, 0xaa04, 0x8983, 0x1841, 0x89a2, 0x5902, 0x38a1, 0xda64, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd244, 0x40a1, 0x6922, 0xfae5, 0x7982, 0x30a1, 0xc203, 0xd264, 0xd243, 0x5921, 0x2061, 0xca64, 0xfb05, 0xd244, 0xc244, 0xca44, 0x38a0, 0x6961, 0xfae5, 0x6923, 0x3081, 0xda64, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd245, 0x40a1, 0x6102, 0xfae5, 0xeaa4, 0xba23, 0xda64, 0xfae4, 0xc244, 0x1881, 0x7942, 0xfac5, 0xfaa5, 0xfaa5, 0xfac4, 0xe244, 0xba04, 0xe2a3, 0xfae4, 0x6903, 0x3081, 0xe264, 0xf2a5, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd245, 0x40a1, 0x6922, 0xfae6, 0xfae5, 0xfb05, 0xfae5, 0xfae4, 0xe284, 0xb203, 0xda83, 0xfac4, 0xfaa5, 0xfac5, 0xfac5, 0xfac5, 0xfb06, 0xfac4, 0xfb05, 0x6943, 0x3080, 0xda63, 0xf2a5, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xd245, 0x40a1, 0x38a1, 0xa1c4, 0x99c3, 0x99a3, 0x99a3, 0x99a3, 0x99a3, 0xa1c3, 0x99a3, 0x9983, 0x99a3, 0x99c3, 0x99a3, 0x99a3, 0x99c3, 0x99a3, 0xa9e4, 0x38a2, 0x3080, 0xe264, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a5, 0xda45, 0x38a1, 0x0, 0x1020, 0x820, 0x820, 0x820, 0x1020, 0x1020, 0x1020, 0x48c2, 0x50e2, 0x1020, 0x1020, 0x1020, 0x1020, 0x1020, 0x1020, 0x1020, 0x0, 0x3081, 0xe264, 0xf2a4, 0xeaa4, 0xeaa4, 0xf2a4, 0x0, 
0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa5, 0xe2a4, 0x7962, 0x0, 0x0, 0x0, 0x0, 0x800, 0x20, 0x1041, 0x2061, 0x4902, 0x5102, 0x1860, 0x1040, 0x20, 0x0, 0x800, 0x800, 0x0, 0x0, 0x6941, 0xea84, 0xf2a4, 0xea84, 0xea84, 0x0, 0x0, 
0x0, 0x0, 0xeaa4, 0xeaa4, 0xf285, 0xf2a4, 0xda83, 0xa9e3, 0xa9c3, 0xa9e3, 0xa9c3, 0xb203, 0xba04, 0x8164, 0x58e3, 0x6102, 0x6102, 0x58e2, 0x8143, 0xb203, 0xb204, 0xa9c3, 0xa9c3, 0xa1c4, 0xa1e3, 0xda64, 0xf285, 0xf284, 0xea84, 0xea84, 0x0, 0x0, 
0x0, 0x0, 0x0, 0xeaa4, 0xea84, 0xf284, 0xf2c4, 0xf2a5, 0xf2a4, 0xf2c4, 0xf2e3, 0xda64, 0x89a3, 0x38a1, 0x1020, 0x1840, 0x1040, 0x1820, 0x3881, 0x8163, 0xda45, 0xfaa5, 0xf2c5, 0xf2a5, 0xf2c4, 0xf2a4, 0xea85, 0xea84, 0xea84, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xea84, 0xeaa5, 0xf2a4, 0xf2a4, 0xf2a4, 0xfac4, 0xa1a4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x99c3, 0xfaa5, 0xf2a5, 0xf2a5, 0xeaa5, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a5, 0xf2a5, 0xd265, 0x99a3, 0x9182, 0x99a2, 0x99a2, 0x99a2, 0x99a2, 0x91a3, 0x91a3, 0xd244, 0xf2a5, 0xeaa5, 0xeaa5, 0xeaa5, 0xf2a5, 0xea84, 0xea84, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa5, 0xf2a4, 0xf2a4, 0xfaa4, 0xfaa4, 0xfaa4, 0xfaa4, 0xfaa4, 0xfaa4, 0xf2a5, 0xfa85, 0xf284, 0xea84, 0xeaa4, 0xeaa5, 0xf2a5, 0xf2a5, 0xf284, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xf2a4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0xeaa4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
};

#define SCROLL_SPEED 0.4

Gfx gCreditsSolidColor[] = {
    gsDPPipeSync(),
    gsSPClearGeometryMode(G_ZBUFFER | G_LIGHTING | G_SHADE),
    gsDPSetCycleType(G_CYC_1CYCLE),
    gsDPSetRenderMode(G_RM_XLU_SURF, G_RM_XLU_SURF2),
    gsDPSetEnvColor(255, 255, 255, 255),
    gsDPSetCombineLERP(0, 0, 0, ENVIRONMENT, 0, 0, 0, ENVIRONMENT, 0, 0, 0, ENVIRONMENT, 0, 0, 0, ENVIRONMENT),
	gsSPEndDisplayList(),
};

void creditsInit(struct Credits* credits) {
    credits->offset = -SCREEN_HT;//0.f;

    initKickflipFont();
}

void creditsUpdate(struct Credits* credits) {

}

void drawTitle(struct RenderState* renderState, unsigned offset){
    char* title1 = "mission";
    char* title2 = "lost control";
    unsigned message1X = (SCREEN_WD - fontMeasure(&gKickflipFont, title1, 1)) >> 1;
    unsigned message2X = (SCREEN_WD - fontMeasure(&gKickflipFont, title2, 0)) >> 1;
    fontRenderText(renderState, &gKickflipFont, title1, message1X-24, 14 - offset, 1);
    fontRenderText(renderState, &gKickflipFont, title2, message2X+12, 45 - offset, 0);
}

void drawDiscordLogo(struct RenderState* renderState, unsigned offset){
    graphicsCopyImage(renderState, discordlogo_img, 32, 32, 0, 0, SCREEN_WD/2 - 16, /*(86+16+61 + 48*4)*/85 - offset, 32, 32, gColorWhite);
}

void drawRoles(struct RenderState* renderState, unsigned offset){
    char* roles[] = {"Art and Graphics", "Music and SFX", "Programming"};

    for(unsigned i = 0; i < 3; ++i){
        fontRenderText(renderState, &gKickflipFont, roles[i], 36, (126 + 48*i) - offset, -1);
    }
    fontRenderText(renderState, &gKickflipFont, "Special Thanks", 36, (125+16+18 + 48*3) - offset, -1);
}

void drawNames(struct RenderState* renderState, unsigned offset){
    char* names[] = {"SapphireTactics", "jtn191", "lambertjamesd"};
    for(unsigned i = 0; i < 3; ++i){
        fontRenderText(renderState, &gKickflipFont, names[i], 39, (126+16 + 48*i) - offset, 0);
    }
    fontRenderText(renderState, &gKickflipFont, "whatswithandy", 39, (125+16+25 + 48*2) - offset, 0);
    fontRenderText(renderState, &gKickflipFont, "CrashOverride95", 39, (125+16+33 + 48*3) - offset, 0);
}

void drawGameJamNote(struct RenderState* renderState, unsigned offset){
    fontRenderText(renderState, &gKickflipFont, "made for", 36, (125+16+24 + 48*4) - offset, 0);
    fontRenderText(renderState, &gKickflipFont, "2021 n64brew", 36, (125+16+43 + 48*4) - offset, 0);
    fontRenderText(renderState, &gKickflipFont, "gamejam", 36, (125+16+61 + 48*4) - offset, 0);
}

void creditsRender(struct Credits* credits, struct RenderState* renderState) {
    spriteSetLayer(renderState, LAYER_SOLID_COLOR, gCreditsSolidColor);
    spriteSetLayer(renderState, LAYER_KICKFLIP_NUMBERS_FONT, gUseKickflipNumbersFont);
    spriteSetLayer(renderState, LAYER_KICKFLIP_FONT, gUseKickflipFont);

    if(controllerGetButtonDown(0, B_BUTTON)) sceneQueueCredits();

    if(!controllerGetButtonDown(0, A_BUTTON)){
        if(credits->offset >= SCREEN_HT*1.775) credits->offset = -SCREEN_HT;
        else credits->offset += SCROLL_SPEED;
    }

    drawTitle(renderState, credits->offset);
    drawDiscordLogo(renderState, credits->offset);
    drawRoles(renderState, credits->offset);
    drawNames(renderState, credits->offset);
    drawGameJamNote(renderState, credits->offset);


    spriteFinish(renderState);
}